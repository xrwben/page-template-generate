<!-- mixin html content -->
<div class="page-content">
    <div class="banner"></div>
    <!-- 活动礼物 -->
    <div class="sec-h txt-s h-gift">活动礼物</div>
    <div class="sec-gifts fl-box">
        <div class="gift-i">
            <div class="g-icon-wrap icon-s g-bg">
                <img class="g-icon" src="${require('./mobile/images/g-mcake.png')}" alt="真爱月饼">
            </div>
            <div class="g-name txt-s txt-g-mooncake">真爱月饼</div>
            <div class="g-price txt-of">10{{ per }}/个</div>
        </div>
        <div class="gift-i">
            <div class="g-icon-wrap icon-s g-bg">
                <img class="g-icon" src="${require('./mobile/images/g-flowermoon.png')}" alt="春花秋月">
            </div>
            <div class="g-name txt-s txt-g-flowermoon">春花秋月</div>
            <div class="g-price txt-of">9999{{ per }}/个</div>
            <div class="g-btn fl-box">
                <div class="btn1-s btn-preview butn" @click="preview('//static.guojiang.tv/app/gift/pc_animation/4922/data.json')">预览</div>
                <div :class="['btn1-s butn', (stage === 6 || stage === 0) ? 'btn-buy-d' : 'btn-buy']" @click="goBuy()">购买</div>
            </div>
        </div>
        <div class="gift-i">
            <div class="g-icon-wrap icon-s g-bg">
                <img class="g-icon" src="${require('./mobile/images/g-rose.png')}" alt="玫瑰花语">
            </div>
            <div class="g-name txt-s txt-g-rose">玫瑰花语</div>
            <div class="g-price txt-of">10{{ per }}/个</div>
            <div class="g-btn fl-box">
                <div class="btn1-s btn-preview butn" @click="preview('//static.guojiang.tv/app/gift/pc_animation/4945/data.json')">预览</div>
            </div>
        </div>
    </div>
    <div class="sec-g-info">
        <p class="phrase">*1{{ per }}=1月圆值=1守护值；</p>
        <p class="phrase">*真爱月饼在直播间礼物栏送出，春花秋月在活动页面购买获取，玫瑰花雨兑换守护碎片获取。</p>
    </div>

    <!-- 战绩盛况 -->
    <div class="sec-h txt-s h-ranks">战绩盛况</div>
    <div class="rank-tab fl-box">
        <div :class="'tab-s butn btn-tab-pre' + (currStage === 'pre' ? '-a' : '')" @click="goStage('pre')">100强入围赛</div>
        <div :class="'tab-s butn btn-tab-getin' + (currStage === 'getin' ? '-a' : '')" @click="goStage('getin')">战队淘汰赛</div>
        <div :class="'tab-s butn btn-tab0-final' + (currStage === 'final' ? '-a' : '')" @click="goStage('final')">战队对决赛</div>
    </div>
    <div class="rank-rules">
        <template v-if="currStage === 'pre'">
            <div class="rule-row rule-h">入围赛规则：</div>
            <div class="rule-row rule-p">1.按照主播月圆值排名，前100名主播晋级下一赛程，该阶段成绩不累计至下一赛程；前十名主播奖励月圆碎片。<span class="icon-s icon-qs butn" @click="pageType !== 'pc' && toggleLayer('preQs')">?<i v-if="pageType === 'pc'" class="qs-tips pre-qs-table"></i></span></div>
            <div class="rule-row rule-h underline"><span class="butn" @click="toggleLayer('layerSegs')">碎片可用于兑换丰厚奖品>>></span></div>
            <div class="rule-row rule-p">2.活动期间，主播月圆值每累计10000，即可获得1个月圆碎片。用户守护值每累计10000，即可获得1个守护碎片。</div>
            <div class="rule-row rule-p">3.守护榜为用户榜，榜单守护值活动全程不清零。</div>
            <div class="rule-row rule-p">4.活动临近结束时送礼量大，服务器会有一定程度的延迟，请提前10秒冲榜，以免成绩未记录榜单。若发生因服务器延迟，造成成绩未记录榜单情况，平台不予补偿，请谅解！</div>
        </template>
        <template v-if="currStage === 'getin'">
            <div class="rule-row rule-h">淘汰赛规则：</div>
            <div class="rule-row rule-p">1.进入淘汰赛的100名主播，按照入围赛排名，共产生10支战队，每队=1名队长+9名队员，每队10人。其中，各队队长=入围赛的前10名主播，各队队员进行S形组队，具体如下：</div>
            <div class="rule-pic rule-pic-t1"></div>
            <div class="rule-row rule-p">2.12日每只战队末尾淘汰2名主播，12日未淘汰的主播累计当日月圆值30%至13日，13日每只战队末尾淘汰3名主播，共计50名主播晋级下一赛程，该赛程成绩不累计至下一赛程。</div>
            <div class="rule-row rule-h">注：若队长被淘汰，则每日战队内第一名顺延为队长。</div>
            <div class="rule-row rule-p">3.每支战队每日未淘汰的主播按照战队月圆值排名，奖励月圆碎片。<span class="icon-s icon-qs butn" @click="pageType !== 'pc' && toggleLayer('getinQs')">?<i v-if="pageType === 'pc'" class="qs-tips getin-qs-table"></i></span></div>
            <div class="rule-row rule-h underline"><span class="butn" @click="toggleLayer('layerSegs')">碎片可用于兑换丰厚奖品>>></span></div>
            <div class="rule-row rule-p">4.活动期间，主播月圆值每累计10000，即可获得1个月圆碎片。用户守护值每累计10000，即可获得1个守护碎片。</div>
            <div class="rule-row rule-p">5.守护榜为用户榜，榜单守护值活动全程不清零。</div>
            <div class="rule-row rule-p">6.活动临近结束时送礼量大，服务器会有一定程度的延迟，请提前10秒冲榜，以免成绩未记录榜单。若发生因服务器延迟，造成成绩未记录榜单情况，平台不予补偿，请谅解！</div>
        </template>
        <template v-if="currStage === 'final'">
            <div class="rule-row rule-h">对决赛规则：</div>
            <div class="rule-row rule-p">1.14日战队按照淘汰赛排名两两PK战队月圆值（1V2，3V4，5V6…），14日未淘汰的主播累计当日月圆值30%至15日，15日进行冠亚季军战队角逐。</div>
            <div class="rule-row rule-p">2.每支战队每日未淘汰的主播按照战队内月圆值排名，奖励月圆碎片。<span class="icon-s icon-qs butn" @click="pageType !== 'pc' && toggleLayer('finalQs')">?<i v-if="pageType === 'pc'" class="qs-tips final-qs-table"></i></span></div>
            <div class="rule-row rule-h underline"><span class="butn" @click="toggleLayer('layerSegs')">碎片可用于兑换丰厚奖品>>></span></div>
            <div class="rule-row rule-p">3.活动期间，主播月圆值每累计10000，即可获得1个月圆碎片。用户守护值每累计10000，即可获得1个守护碎片。</div>
            <div class="rule-row rule-p">4.守护榜为用户榜，榜单守护值活动全程不清零。</div>
            <div class="rule-row rule-p">5.活动临近结束时送礼量大，服务器会有一定程度的延迟，请提前10秒冲榜，以免成绩未记录榜单。若发生因服务器延迟，造成成绩未记录榜单情况，平台不予补偿，请谅解！</div>
        </template>
    </div>

    <!-- 榜单部分 -->
    <div class="type-tab fl-box">
        <div :class="['tab-i butn', modTabName[currStage] + (tabType === 'mod' ? '-a' : '')]" @click="goModTab">主播榜</div>
        <div :class="'tab-i butn btn1-s btn-tab-user' + (tabType === 'user' ? '-a' : '')" @click="goUserTab">守护榜</div>
    </div>
    <div :class="['rank-content', listType, 'stage-' + showStage]">
        <div class="rank-c-i">
            <!-- 1. 入围主播榜 表头 list-header -->
            <div v-if="listType === 'pre' || listType === 'user'" class="list-h fl-box">
                <div class="list-cell list-cell1"><span class="txt-s txt-r1-c1">排名</span></div>
                <div class="list-cell list-cell2"><span :class="['txt-s', listType === 'pre' ? 'txt-r1-c2' : 'txt-r2-c2']"></span></div>
                <div class="list-cell list-cell3"><span :class="['txt-s', listType === 'pre' ? 'txt-r1-c3' : 'txt-r2-c3']"></span></div>
            </div>
            <!-- 2. 淘汰榜 日期切换tab list-date-tab -->
            <div v-if="listType === 'getin'" class="list-tab fl-box">
                <div :class="'tab-i butn btn2-s btn-tab-date-12' + (showStage === 2 ? '-a' : '')" @click="changeShowStage(2)">12日</div>
                <div :class="'tab-i butn btn2-s btn-tab-date-13' + (showStage === 3 ? '-a' : '')" @click="changeShowStage(3)">13日</div>
            </div>
            <!-- 3. 决赛pk 日期切换tab list-date-tab -->
            <div v-if="listType === 'final'" class="list-tab fl-box">
                <div :class="'tab-i butn btn3-s btn-tab-date-14' + (showStage === 4 ? '-a' : '')" @click="changeShowStage(4)">14日</div>
                <div :class="'tab-i butn btn3-s btn-tab-date-15' + (showStage === 5 ? '-a' : '')" @click="changeShowStage(5)">15日</div>
            </div>
            
            <!-- 内容分发 block S -->
            <scroller
                class="list-c"
                ref="rank-scroller"
                :right="6"
                :thumb-color="'#fff'">
                <!-- 1. 入围主播榜 -->
                <template v-if="listType === 'pre'">
                    <div v-for="(li, ind) in ranks" :key="'pre_' + ind" :class="['list-tr fl-box', rwweiSeg[ind] && 'with-tips']">
                        <div class="list-cell list-cell1">
                            <div v-if="ind < 3" :class="'icon-s badge-' + (ind + 1)"></div>
                            <div v-else class="index">{{ ind + 1 }}</div>
                        </div>
                        <div class="list-cell list-cell2 fl-ver">
                            <div class="headpic">
                                <img v-if="li.headPic" class="avatar" :src="li.headPic" alt="" @click="goRoom(li)">
                                <img v-else class="avatar holder" src="${require('./mobile/images/avatar-holder.png')}" alt="">
                                <div v-if="ind < 3" :class="'icon-s icon-cown cown-' + (ind + 1)"></div>
                                <div v-if="li.isPlaying" class="icon-s icon-live"></div>
                            </div>
                            <div class="nick txt-of">{{ li.nickname }}</div>
                            <span :class="'level_icon m_level_icon_' + li.level"></span>
                        </div>
                        <div class="list-cell list-cell3 txt-of">{{ li.score }}</div>
                        <div v-if="rwweiSeg[ind]" class="list-tr-tips">11日结算时奖励{{ rwweiSeg[ind] }}月圆碎片</div>
                    </div>
                </template>
                <!-- 2. 用户榜 -->
                <template v-if="listType === 'user'">
                    <div v-for="(li, ind) in ranks" :key="'user_' + ind" class="list-tr fl-box">
                        <div class="list-cell list-cell1">
                            <div v-if="ind < 3" :class="'icon-s badge-' + (ind + 1)"></div>
                            <div v-else class="index">{{ ind + 1 }}</div>
                        </div>
                        <div class="list-cell list-cell2 fl-ver">
                            <div class="headpic">
                                <img v-if="li.headPic" class="avatar" :src="li.headPic" alt="">
                                <img v-else class="avatar holder" src="${require('./mobile/images/avatar-holder.png')}" alt="">
                                <div v-if="ind < 3" :class="'icon-s icon-cown cown-' + (ind + 1)"></div>
                            </div>
                            <div class="nick txt-of">{{ li.nickname }}</div>
                            <span :class="'level_icon u_level_icon_' + li.level"></span>
                        </div>
                        <div class="list-cell list-cell3 txt-of">{{ li.score }}</div>
                    </div>
                </template>
                <!-- 3. 淘汰日榜 12/13 -->
                <template v-if="listType === 'getin'">
                    <div v-for="(item, ind) in 10" :key="'getin_r_' + ind" class="list-tr fl-box">
                        <div class="list-cell list-cell1">
                            <div v-if="ind < 3" :class="'icon-s badge-' + (ind + 1)"></div>
                            <div v-else class="index">{{ ind + 1 }}</div>
                        </div>
                        <div class="list-cell list-cell2 fl-ver">
                            <div class="headpic">
                                <img v-if="teamRanks.list[ind]" class="avatar" :src="teamRanks.list[ind].headPic" alt="" @click="goRoom(teamRanks.list[ind])">
                                <img v-else class="avatar holder" src="${require('./mobile/images/avatar-holder.png')}" alt="">
                                <div v-if="ind < 3" :class="'icon-s icon-cown cown-' + (ind + 1)"></div>
                                <div v-if="teamRanks.list[ind] && teamRanks.list[ind].isPlaying" class="icon-s icon-live"></div>
                            </div>
                            <div class="teaminfo">
                                <div class="nick txt-of">队长：{{ teamRanks.list[ind] ? teamRanks.list[ind].nickname : '虚位以待'  }}</div>
                                <div class="score txt-of">战队月圆值：{{ teamRanks.list[ind] ? teamRanks.list[ind].score : '--'  }}</div>
                            </div>
                        </div>
                        <div class="list-cell list-cell3 txt-of">
                            <div class="btn2-s btn-all butn" @click="teamRanks.list[ind] && showTeams(teamRanks.list[ind].group, ind)">展开全部队员</div>
                        </div>
                    </div>
                </template>
                <!-- 4. 决赛日榜 pk 14 -->
                <template v-if="listType === 'final' && showStage === 4">
                    <div v-for="(item, ind) in pkRanksWash" class="list-tr">
                        <div class="progress">
                            <span class="score score-a" :style="{ width: item.progress + '%' }">{{ item.score || 0 }}</span>
                            <span class="score score-b" :style="{ width: (100 - (+item.progress)) + '%' }">{{ item.to_score || 0 }}</span>
                        </div>

                        <div class="pk-box fl-box">
                            <div :class="['left-side', stage > 4 && item.winner === 0 && 'lose-mask']">
                                <div class="headpic">
                                    <img class="avatar" :src="item.headPic" alt="" @click="goRoom({ rid: item.rid, id: item.id })">
                                    <div v-show="item.isPlaying" class="icon-s icon-live"></div>
                                </div>
                                <div class="nick txt-of">队长：{{ item.nickname || '-' }}</div>
                                <div class="score txt-of">战队月圆值：{{ item.score | pkScoreElip }}</div>
                                <div class="btn2-s btn-all butn" @click="showTeams(item.group, 0)">展开全部队员</div>
                                <div v-if="stage > 4 && item.winner !== undefined" :class="['pk-res icon-s', item.winner === 1 ? 'icon-pk-win' : 'icon-pk-lose']"></div>
                            </div>
                            <div class="icon-s icon-vs">vs</div>
                            <div :class="['right-side', stage > 4 && item.winner === 1 && 'lose-mask']">
                                <div class="headpic">
                                    <img class="avatar" :src="item.to_headPic" alt="" @click="goRoom({ rid: item.to_rid, id: item.to_id })">
                                    <div v-show="item.to_isPlaying" class="icon-s icon-live"></div>
                                </div>
                                <div class="nick txt-of">队长：{{ item.to_nickname || '-' }}</div>
                                <div class="score txt-of">战队月圆值：{{ item.to_score | pkScoreElip }}</div>
                                <div class="btn2-s btn-all butn" @click="showTeams(item.to_group, 0)">展开全部队员</div>
                                <div v-if="stage > 4 && item.winner !== undefined" :class="['pk-res icon-s', item.winner === 0 ? 'icon-pk-win' : 'icon-pk-lose']"></div>
                            </div>
                        </div>
                    </div>
                </template>
                <!-- 5. 决赛日榜 pk 15 -->
                <template v-if="listType === 'final' && showStage === 5">
                    <div v-for="(item, ind) in 5" :class="['list-tr fl-box', ind === 0 && 'with-tips']">
                        <div class="list-cell list-cell1">
                            <div v-if="ind < 3" :class="'icon-s badge-' + (ind + 1)"></div>
                            <div v-else class="index">{{ ind + 1 }}</div>
                        </div>
                        <div class="list-cell list-cell2 fl-ver">
                            <div class="headpic">
                                <img v-if="teamRanks.list[ind]" class="avatar" :src="teamRanks.list[ind].headPic" alt="" @click="goRoom(teamRanks.list[ind])">
                                <img v-else class="avatar holder" src="${require('./mobile/images/avatar-holder.png')}" alt="">
                                <div v-if="ind < 3" :class="'icon-s icon-cown cown-' + (ind + 1)"></div>
                                <div v-if="teamRanks.list[ind] && teamRanks.list[ind].isPlaying" class="icon-s icon-live"></div>
                            </div>
                            <div class="teaminfo">
                                <div class="nick txt-of">队长：{{ teamRanks.list[ind] ? teamRanks.list[ind].nickname : '虚位以待'  }}</div>
                                <div class="score txt-of">战队月圆值：{{ teamRanks.list[ind] ? teamRanks.list[ind].score : '--'  }}</div>
                            </div>
                        </div>
                        <div class="list-cell list-cell3 txt-of">
                            <div class="btn2-s btn-all butn" @click="teamRanks.list[ind] && showTeams(teamRanks.list[ind].group, ind)">展开全部队员</div>
                        </div>
                        <div v-if="ind === 0" class="txt-s txt-final-tips">15日23:59:59结算时，第一名战队的第一名主播为月桂女神</div>
                    </div>
                </template>
            </scroller>
            <div v-show="listType === 'pre'" class="list-tips">仅展示前100位主播</div>
            <div v-show="listType === 'user'" class="list-tips">仅展示前100位用户</div>
            <!-- 1. 入围主播榜 用户榜 个人中心 -->
            <template v-if="listType === 'pre' || listType === 'user'">
                <div v-if="mainRanks.meCenter" class="me-center fl-box">
                    <div class="brief">
                        <div class="headpic">
                            <img class="avatar" :src="mainRanks.meCenter.headPic" alt="" @click="listType === 'pre' && goRoom(mainRanks.meCenter)">
                            <div v-if="mainRanks.meCenter.isPlaying" class="icon-s icon-live"></div>
                        </div>
                        <div class="nickname fl-box">
                            <div class="nick txt-of">{{ mainRanks.meCenter.nickName }}</div>
                            <span :class="['level_icon', (listType === 'pre' ? 'm_level_icon_' : 'u_level_icon_') + mainRanks.meCenter.level]"></span>
                        </div>
                    </div>
                    <div class="pairinfos">
                        <div v-for="i in [0, 2, 1, 3]" :key="'pf_' + listType + '_' + i" class="info-i">
                            <div class="name">{{ mainRanks.meCenter.pairInfos[i].name }}</div>
                            <div class="value">{{ mainRanks.meCenter.pairInfos[i].value }}</div>
                        </div>
                    </div>
                </div>
            </template>
            <!-- 2. 淘汰日榜 个人中心 -->
            <template v-if="listType === 'getin'">
                <div v-if="teamRanks.meCenter" class="me-center fl-box">
                    <div class="center-c1">{{ getInCenterTeamRank }}</div>
                    <div class="center-c2 fl-ver">
                        <div class="head-info">
                            <div class="headpic">
                                <img class="avatar" :src="teamRanks.meCenter.headPic" alt="" @click="goRoom(teamRanks.meCenter)">
                                <div v-if="teamRanks.meCenter.isPlaying" class="icon-s icon-live"></div>
                            </div>
                            <div class="nickname fl-box">
                                <div class="nick txt-of">{{ teamRanks.meCenter.nickName }}</div>
                                <span :class="'level_icon m_level_icon_' + teamRanks.meCenter.level"></span>
                            </div>
                        </div>
                        <div class="my-team">
                            <div class="score txt-of">战队月圆值：{{ teamRanks.meCenter.groupScore }}</div>
                            <div class="inner-rank txt-of">队内排名：{{ teamRanks.meCenter.rank }}</div>
                            <div class="tips txt-of">{{ getInCenterTips }}</div>
                        </div>
                    </div>
                    <div class="center-c3 txt-of">
                        <div class="btn2-s btn-all butn" @click="showTeamsBySearch(groupId)">展开全部队员</div>
                    </div>
                </div>
            </template>
            <!-- 内容分发 block E -->
        </div>
    </div>

    <p class="copyright">本活动最终解释权归平台运营团队所有</p>
</div>

<div class="floater">
    <div class="btn1-s btn-rule butn" @click="toggleLayer('layerSegs')">碎片玩法</div>
    <div class="btn1-s btn-reward butn" @click="toggleLayer('layerReward')">活动奖励</div>
</div>

<!-- layers -->
<div v-show="preQs" class="layer pre-qs fl-box" @click="toggleLayer('preQs')">
    <div class="pre-qs-table" @click.stop=""></div>
</div>

<div v-show="getinQs" class="layer getin-qs fl-box" @click="toggleLayer('getinQs')">
    <div class="getin-qs-table" @click.stop=""></div>
</div>

<div v-show="finalQs" class="layer fl-box final-qs" @click="toggleLayer('finalQs')">
    <div class="final-qs-table" @click.stop=""></div>
</div>

<!-- 1. 购买弹层 -->
<buy-modal ref="buyModal" :price="9999" @purchase="goPurchase"></buy-modal>

<!-- 2. 余额不足弹层 -->
<div v-show="layerCharge" class="layer fl-box layer-charge" @click="toggleLayer('layerCharge')">
    <div class="layer-content" @click.stop="">
        <div class="btn-layer-s btn-close butn" @click="toggleLayer('layerCharge')"></div>
        <div class="layer-main">
            <p class="txt">余额不足，快去充值吧！</p>
            <div class="opts fl-box">
                <div class="btn-layer-s btn-cancel butn" @click="toggleLayer('layerCharge')">不了</div>
                <div class="btn-layer-s btn-charge butn" @click="goRecharge">充值</div>
            </div>
        </div>
    </div>
</div>

<!-- 3. 战队内排名 -->
<div v-show="layerTeam" class="layer fl-box layer-team" @click="toggleLayer('layerTeam')">
    <div class="layer-content" :style="showStage !== 5 ? { height: '80%' } : {}" @click.stop="">
        <div class="btn-layer-s btn-close butn" @click="toggleLayer('layerTeam')"></div>
        <div class="layer-main">
            <div class="list-h fl-box">
                <div class="list-cell list-cell1"><span class="txt-s txt-r1-c1">排名</span></div>
                <div class="list-cell list-cell2"><span class="txt-s txt-r1-c2">主播</span></div>
                <div class="list-cell list-cell3"><span class="txt-s txt-r1-c3">月圆值</span></div>
            </div>
            <scroller
                class="list-c"
                ref="team-scroller"
                :right="32"
                :thumb-color="'#fff'">
                <template v-for="(item, ind) in teamMembersNum">
                    <div :class="['list-tr fl-box', teamRankInd >= 0 && ind < teamSeg.length && 'with-tips']">
                        <div class="list-cell list-cell1">
                            <div v-if="ind < 3" :class="'icon-s badge-' + (ind + 1)"></div>
                            <div v-else class="index">{{ ind + 1 }}</div>
                        </div>
                        <div class="list-cell list-cell2 fl-ver">
                            <div class="headpic">
                                <img v-if="teamMembers[ind]" class="avatar" :src="teamMembers[ind].headPic" alt="" @click="goRoom(teamMembers[ind])">
                                <img v-else class="avatar holder" src="${require('./mobile/images/avatar-holder.png')}" alt="">
                                <div v-if="teamMembers[ind] && teamMembers[ind].isPlaying" class="icon-s icon-live"></div>
                            </div>
                            <div class="nick txt-of">{{ teamMembers[ind] ? teamMembers[ind].nickname : '虚位以待' }}</div>
                            <span v-if="teamMembers[ind]" :class="'level_icon m_level_icon_' + teamMembers[ind].level"></span>
                        </div>
                        <div class="list-cell list-cell3 txt-of">{{ teamMembers[ind] ? teamMembers[ind].score : '-' }}</div>
                        <div v-if="showStage !== 4 && teamRankInd >= 0 && ind < teamSeg.length" class="list-tr-tips">{{ teamSegDate }}日结算时奖励{{ teamSeg[ind] }}月神碎片</div>
                        <div v-if="showStage === 4 && teamRankInd >= 0 && ind < teamSeg.length" class="list-tr-tips">{{ teamSegDate }}日结算时若胜利，奖励{{ teamSeg[ind] }}月圆碎片</div>
                    </div>
                    <div v-if="showStage < 4 && ind === (teamSeg.length - 1)" class="list-sep fl-box">
                        <span class="list-team-date">{{ teamSegDate }}</span>
                        <span class="layer-txt-s txt-getin-info">日23:59:59结算时，以下主播淘汰</span>
                    </div>
                </template>
            </scroller>
        </div>
    </div>
</div>

<!-- 4. 活动奖励 -->
<div v-show="layerReward" class="layer fl-box layer-reward" @click="toggleLayer('layerReward')">
    <div class="layer-content" @click.stop="">
        <div class="btn-layer-s btn-close butn" @click="toggleLayer('layerReward')"></div>
        <div class="layer-h layer-txt-s h-rewards"></div>
        <scroller
            class="layer-main"
            ref="rw-scroller"
            :right="32"
            :thumb-color="'#fff'">
            <div class="rw-h">奖励说明：</div>
            <div class="rw-i">1.若战队队员15日少于50000月圆值，则不发放该队员奖励；</div>
            <div class="rw-i">2.月桂女神开屏会在活动结束的5个工作日内和主播联系排期；</div>
            <div class="rw-i">3.{{ per }}奖励会在活动结束的5个工作日内发放。</div>
            <div class="rw-table">
                <div class="rw-t-row fl-box">
                    <div class="rw-t-cell cell1">名次</div>
                    <div class="rw-t-cell cell2">奖励</div>
                </div>
                <div class="rw-t-row fl-box">
                    <div class="rw-t-cell cell1">冠军战队TOP1</div>
                    <div class="rw-t-cell cell2">350000 {{ per }}<br/>月桂女神开屏*2日</div>
                </div>
                <div class="rw-t-row fl-box">
                    <div class="rw-t-cell cell1">冠军战队TOP2</div>
                    <div class="rw-t-cell cell2">100000{{ per }}</div>
                </div>
                <div class="rw-t-row fl-box">
                    <div class="rw-t-cell cell1">冠军战队TOP3</div>
                    <div class="rw-t-cell cell2">80000{{ per }}</div>
                </div>
                <div class="rw-t-row fl-box">
                    <div class="rw-t-cell cell1">冠军战队TOP4</div>
                    <div class="rw-t-cell cell2">50000{{ per }}</div>
                </div>
                <div class="rw-t-row fl-box">
                    <div class="rw-t-cell cell1">冠军战队TOP5</div>
                    <div class="rw-t-cell cell2">50000{{ per }}</div>
                </div>
                <div class="rw-t-row fl-box">
                    <div class="rw-t-cell cell1">亚军战队TOP1</div>
                    <div class="rw-t-cell cell2">200000{{ per }}</div>
                </div>
                <div class="rw-t-row fl-box">
                    <div class="rw-t-cell cell1">亚军战队TOP2</div>
                    <div class="rw-t-cell cell2">60000{{ per }}</div>
                </div>
                <div class="rw-t-row fl-box">
                    <div class="rw-t-cell cell1">亚军战队TOP3</div>
                    <div class="rw-t-cell cell2">50000{{ per }}</div>
                </div>
                <div class="rw-t-row fl-box">
                    <div class="rw-t-cell cell1">亚军战队TOP4</div>
                    <div class="rw-t-cell cell2">40000{{ per }}</div>
                </div>
                <div class="rw-t-row fl-box">
                    <div class="rw-t-cell cell1">亚军战队TOP5</div>
                    <div class="rw-t-cell cell2">40000{{ per }}</div>
                </div>
                <div class="rw-t-row fl-box">
                    <div class="rw-t-cell cell1">季军战队TOP1</div>
                    <div class="rw-t-cell cell2">150000{{ per }}</div>
                </div>
                <div class="rw-t-row fl-box">
                    <div class="rw-t-cell cell1">季军战队TOP2</div>
                    <div class="rw-t-cell cell2">50000{{ per }}</div>
                </div>
                <div class="rw-t-row fl-box">
                    <div class="rw-t-cell cell1">季军战队TOP3</div>
                    <div class="rw-t-cell cell2">40000{{ per }}</div>
                </div>
                <div class="rw-t-row fl-box">
                    <div class="rw-t-cell cell1">季军战队TOP4</div>
                    <div class="rw-t-cell cell2">30000{{ per }}</div>
                </div>
                <div class="rw-t-row fl-box">
                    <div class="rw-t-cell cell1">季军战队TOP5</div>
                    <div class="rw-t-cell cell2">30000{{ per }}</div>
                </div>
            </div>
        </scroller>
    </div>
</div>

<!-- 5. 碎片玩法 -->
<div v-show="layerSegs" class="layer fl-box layer-segs" @click="toggleLayer('layerSegs')">
    <div class="layer-content" @click.stop="">
        <div class="btn-layer-s btn-close butn" @click="toggleLayer('layerSegs')"></div>
        <div class="layer-h layer-txt-s h-segs"></div>
        <scroller
            class="layer-main"
            ref="segs-scroller"
            :right="32"
            :thumb-color="'#fff'">
            <div class="txt-i">活动期间，主播月圆值每累计10000，即可获得1个月圆碎片。用户守护值每累计10000，即可获得1个守护碎片。主播累计月圆碎片和用户累计守护碎片到以下标准，可兑换对应奖励。兑换时间截止至9.16 23:59:59，逾期失效。</div>

            <div class="msg-board">
                <div class="msg-board-warp">
                    <div class="msg-board-c" ref="msgBoard">
                        <div v-for="(info, ifi) in segBoard" :key="'board_1_' + ifi" class="msg-info">{{ info }}</div>
                        <div v-for="(info, ifi) in segBoard" :key="'board_2_' + ifi" class="msg-info">{{ info }}</div>
                    </div>
                </div>
            </div>

            <div class="btn-layer-s btn-mysegs butn" @click="showDraw">查看我的兑换</div>
            
            <div v-if="isMod" class="segs-tab fl-box">
                <div :class="['tab-i btn-layer-s butn', tabSegs === 'mod' ? 'btn-tab-seg-yy-a' : 'btn-tab-seg-yy']" @click="goSegsTab('mod')">月圆碎片兑换</div>
                <div :class="['tab-i btn-layer-s butn', tabSegs === 'user' ? 'btn-tab-seg-sh-a' : 'btn-tab-seg-sh']" @click="goSegsTab('user')">守护碎片兑换</div>
            </div>

            <div v-if="tabSegs === 'mod'" class="segs-list">
                <div v-for="(seg, sgi) in seglist.mod" :key="'seg_mod_' + sgi" class="segs-i fl-box">
                    <div class="segs-icon seg-s seg-bg fl-box">
                        <div class="seg-s" :data-name="seg.name"></div>
                    </div>
                    <div class="segs-info">
                        <div class="segs-name fl-ver">
                            <span class="layer-txt-s" :data-name="seg.name">{{ seg.name }} </span>
                            <span v-if="seg.name === '5min1.2倍月圆值buff卡'" class="icon-s icon-qs" @click="pageType !== 'pc' && showTips('兑换成功buff卡后，直播间即时开启5分钟月圆值加成：用户送出10' + per + '活动礼物，用户活动榜单记录10守护值，主播活动榜单记录12月圆值。最新触发的buff覆盖正在生效的buff，生效时间不叠加。')">
                                <b v-if="pageType === 'pc'" class="pc-tips">兑换成功buff卡后，直播间即时开启5分钟月圆值加成：用户送出10{{ per }}活动礼物，用户活动榜单记录10守护值，主播活动榜单记录12月圆值。最新触发的buff覆盖正在生效的buff，生效时间不叠加。</b>
                            </span>
                        </div>
                        <div class="segs-desc">{{ seg.desc }}</div>
                    </div>
                    <div class="segs-opt">
                        <div v-if="seg.nums" class="segs-num">{{ seg.nums[0] }}：{{ seg.nums[2] - seg.nums[1] }}/{{ seg.nums[2] }}</div>
                        <div :class="['btn-layer-s butn', (stage === 0 || seg.isExchange !== false) ? 'btn-draw' : 'btn-draw-d']" @click="(stage === 0 || seg.isExchange !== false) && drawSeg('mod', seg)">兑换</div>
                        <div class="segs-need">{{ seg.val }}月圆碎片</div>
                    </div>
                </div>
            </div>

            <div v-if="tabSegs === 'user'" class="segs-list">
                <div v-for="(seg, sgi) in seglist.user" :key="'seg_usr_' + sgi" class="segs-i fl-box">
                    <div class="segs-icon seg-s seg-bg fl-box">
                        <div class="seg-s" :data-name="seg.name"></div>
                    </div>
                    <div class="segs-info">
                        <div class="segs-name fl-ver">
                            <div :class="seg.name === '5min1.2倍粉丝亲密度buff卡' && 'scale-wrapper'">
                                <span class="layer-txt-s" :data-name="seg.name">{{ seg.name }}</span>
                            </div>
                            <span v-if="seg.name === '5min1.2倍粉丝亲密度buff卡'" class="icon-s icon-qs" @click="pageType !== 'pc' && showTips('兑换成功buff卡后，在成为主播粉丝团成员的直播间即时开启5分钟粉丝亲密度加成：送出10' + per + '活动礼物，记录12粉丝亲密度。最新触发的buff覆盖正在生效的buff，生效时间不叠加。')">
                                <b v-if="pageType === 'pc'" class="pc-tips">兑换成功buff卡后，在成为主播粉丝团成员的直播间即时开启5分钟粉丝亲密度加成：送出10{{ per }}活动礼物，记录12粉丝亲密度。最新触发的buff覆盖正在生效的buff，生效时间不叠加。</b>
                            </span>
                        </div>
                        <div class="segs-desc">{{ seg.desc.replace('克拉', per) }}</div>
                    </div>
                    <div class="segs-opt">
                        <div v-if="seg.nums" class="segs-num">{{ seg.nums[0] }}：{{ seg.nums[2] - seg.nums[1] }} / {{ seg.nums[2] }}</div>
                        <div :class="['btn-layer-s butn', (stage === 0 || seg.isExchange !== false) ? 'btn-draw' : 'btn-draw-d']" @click="(stage === 0 || seg.isExchange !== false) && drawSeg('user', seg)">兑换</div>
                        <div class="segs-need">{{ seg.val }}守护碎片</div>
                    </div>
                </div>
            </div>
        </scroller>
    </div>
</div>

<!-- 6. 我的兑换 -->
<div v-show="layerDraw" class="layer fl-box layer-draw" @click="toggleLayer('layerDraw')">
    <div class="layer-content" @click.stop="">
        <div class="btn-layer-s btn-close butn" @click="toggleLayer('layerDraw')"></div>
        <div class="layer-main">
            <div v-if="isMod" class="segs-tab fl-box">
                <div :class="['tab-i btn-layer-s butn', tabDrawSegs === 'mod' ? 'btn-tab-seg-yy-a' : 'btn-tab-seg-yy']" @click="goDrawTab('mod')">月圆碎片兑换</div>
                <div :class="['tab-i btn-layer-s butn', tabDrawSegs === 'user' ? 'btn-tab-seg-sh-a' : 'btn-tab-seg-sh']" @click="goDrawTab('user')">守护碎片兑换</div>
            </div>
            <div class="draw-th fl-box">
                <div class="draw-td draw-td-1">
                    <div class="layer-txt-s txt-draw-c1">时间</div>
                </div>
                <div class="draw-td draw-td-2">
                    <div class="layer-txt-s txt-draw-c2">兑换详情</div>
                </div>
                <div class="draw-td draw-td-3">
                    <div :class="['layer-txt-s', tabDrawSegs === 'mod' ? 'txt-draw-c3' : 'txt-draw-c3-u']">消耗碎片</div>
                </div>
            </div>
            <scroller
                class="draw-tbody"
                ref="draw-scroller"
                :right="32"
                :thumb-color="'#fff'">
                <div v-for="(di, i) in drawInfos" :key="'di_' + i" class="draw-tr fl-box">
                    <div class="draw-td draw-td-1">{{ di.time }}</div>
                    <div class="draw-td draw-td-2 txt-of">{{ di.gift }}</div>
                    <div class="draw-td draw-td-3 txt-of">{{ di.pieces }}</div>
                </div>
                <div v-if="drawInfos.length === 0" class="draw-holder">呀，还没有兑换记录呢~</div>
            </scroller>
            <div class="center fl-box">
                <div class="infos">
                    <div class="info-i txt-of">你一共获得<span class="bold">{{ drawCenter.total }}</span>个{{ tabDrawSegs === 'mod' ? '月圆' : '守护' }}碎片</div>
                    <div class="info-i txt-of">你已经消耗<span class="bold">{{ drawCenter.exchanged }}</span>个{{ tabDrawSegs === 'mod' ? '月圆' : '守护' }}碎片</div>
                    <div class="info-i txt-of">你还剩<span class="bold">{{ drawCenter.left }}</span>个{{ tabDrawSegs === 'mod' ? '月圆' : '守护' }}碎片</div>
                </div>
                <div class="prog">
                    <div class="tube" :style="{ width: (drawCenter.score % 10000 / 10000 * 100) + '%' }"></div>
                    <span class="value">{{ drawCenter.score % 10000 }}/10000</span>
                </div>
            </div>
        </div>
    </div>
</div>

<!-- 7. 确认兑换提示框 -->
<div v-show="layerSegConfirm" class="layer fl-box layer-seg-confirm" @click="toggleLayer('layerSegConfirm')">
    <div class="layer-content" @click.stop="">
        <div class="btn-layer-s btn-close butn" @click="toggleLayer('layerSegConfirm')"></div>
        <div class="layer-main">
            <p v-if="segConfirm.type === 'mod'" class="txt">小主，确定要消耗{{ segConfirm.val }}个月圆碎片，兑换{{ segConfirm.name }}吗？</p>
            <p v-if="segConfirm.type === 'user'" class="txt">用户大大，确定要消耗{{ segConfirm.val }}个守护碎片，兑换{{ segConfirm.name }}吗？</p>
            <div class="opts fl-box">
                <div class="btn-layer-s btn-look butn" @click="toggleLayer('layerSegConfirm')">我再看看</div>
                <div class="btn-layer-s btn-draw butn" @click="confirmDraw">兑换</div>
            </div>
        </div>
    </div>
</div>

<!-- tips -->
<div v-show="tipsStatus" class="tips-wrapper fl-box" @click="hideTips">
    <div class="tips">{{ tips }}</div>
</div>

<loading ref="loading"></loading>

<toast ref="toast"></toast>

<svg-player ref="svgPlayer"></svg-player>
<!-- mixin html content -->
