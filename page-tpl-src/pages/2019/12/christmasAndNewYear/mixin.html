<!-- mixin html content -->
<div class="page-content">
    <!-- <div class="top-title"></div> -->
    <!-- 霸屏时刻 -->
    <div class="hold-screen">
        <div class="title">
            <div class="hold-rule-btn" @click="showBpRule=true"></div>
            <div class="hold-rule-con" v-if="showBpRule">
                <div class="content">
                    <span class="close" @click="showBpRule=false">关闭</span>
                    <img v-if="giftPer==='克拉'" src="${require('./images/popup-bpgz-kl.png')}" alt="">
                    <img v-if="giftPer==='花瓣'" src="${require('./images/popup-bpgz-hb.png')}" alt="">
                    <img v-if="giftPer==='甜蜜'" src="${require('./images/popup-bpgz-tm.png')}" alt="">
                </div>
            </div>
        </div>
        <div class="screen-container">
            <div class="now-block">
                <div class="sub-title now-title"><span ref="countdown" class="countdown" v-show="[1, 2].includes(activityStatus)"></span></div>
                <div class="now-con">
                    <div class="tip-group" v-if="[1, 2].includes(activityStatus)">
                        <div class="now-hold" v-if="nowHoldScreen">
                            <div class="list-item">
                                <div class="item-1">
                                    <img :src="nowHoldScreen.userHeadPic" alt="">
                                </div>
                                <div class="item-2">
                                    <p class="name txt-of">{{ nowHoldScreen.userName }}</p>
                                    <div class="icon"></div>
                                </div>
                                <div class="item-3" @click="redirectRoom(nowHoldScreen)">
                                    <img :src="nowHoldScreen.modHeadPic" alt="">
                                </div>
                                <div class="item-4">
                                    <p class="name txt-of">{{ nowHoldScreen.modName }}</p>
                                </div>
                                <div class="item-5">
                                    <img :src="nowHoldScreen.icon" alt="">
                                </div>
                                <div class="item-6">
                                    <p class="name txt-of">{{ nowHoldScreen && nowHoldScreen.giftName.split(',')[0] }}</p>
                                    <p class="name txt-of">{{ nowHoldScreen && nowHoldScreen.giftName.split(',')[1] }}</p>
                                </div>
                            </div>
                            <div class="tip">tip: 一次性赠送礼物价值高于当前霸屏礼物即可抢占当前霸屏位。</div>
                        </div>
                        <div v-if="!nowHoldScreen" class="tip-1">一次性送出价值≥52000{{ giftPer }}的活动礼物，即可与主播一起抢占全站直播间霸屏位。</div>
                    </div>
                    <div class="tip-group"  v-if="[0, -1, 3].includes(activityStatus)">
                        <div v-if="[0, 3].includes(activityStatus)" class="tip-1">活动期间开启霸屏！</div>
                        <div v-if="activityStatus===-1" class="tip-1">活动已结束~</div>
                    </div>
                </div>
            </div>
            <div class="history-block">
                <div class="sub-title his-title"></div>
                <div class="his-con">
                    <div class="tip" v-if="!historyHoldScreen.length">快去霸屏，享受全站瞩目！</div>
                    <div id="history-rollup-holdscreen" class="list-con history-rollup-holdscreen" v-if="historyHoldScreen.length">
                        <div class="list-item" v-for="item in historyHoldScreen">
                            <div class="item-1">
                                <img :src="item.userHeadPic" alt="">
                            </div>
                            <div class="item-2">
                                <p class="name txt-of">{{ item.userName }}</p>
                                <div class="icon"></div>
                            </div>
                            <div class="item-3">
                                <img :src="item.modHeadPic" alt="">
                            </div>
                            <div class="item-4">
                                <p class="name txt-of">{{ item.modName }}</p>
                            </div>
                            <div class="item-5">
                                <img :src="item.icon" alt="">
                            </div>
                            <div class="item-6">
                                <p class="name txt-of">{{ item.giftName.split(',')[0] }}</p>
                                <p class="name txt-of">{{ item.giftName.split(',')[1] }}</p>
                            </div>
                        </div>
                    </div>
                    <div id="history-rollup-holdscreen" class="list-con history-rollup-holdscreen" v-if="historyHoldScreen.length > 4">
                        <div class="list-item" v-for="item in historyHoldScreen">
                            <div class="item-1">
                                <img :src="item.userHeadPic" alt="">
                            </div>
                            <div class="item-2">
                                <p class="name txt-of">{{ item.userName }}</p>
                                <div class="icon"></div>
                            </div>
                            <div class="item-3">
                                <img :src="item.modHeadPic" alt="">
                            </div>
                            <div class="item-4">
                                <p class="name txt-of">{{ item.modName }}</p>
                            </div>
                            <div class="item-5">
                                <img :src="item.icon" alt="">
                            </div>
                            <div class="item-6">
                                <p class="name txt-of">{{ item.giftName.split(',')[0] }}</p>
                                <p class="name txt-of">{{ item.giftName.split(',')[1] }}</p>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </div>
    <!-- 双旦限定 -->
    <div class="activity-gift">
        <div class="title"></div>
        <div class="gift-container">
            <div class="gift-block christmas">
                <div class="gift-tab">
                    <div v-show="currentGift==='christmas'" class="sd-tab-1"></div>
                    <div v-show="currentGift==='newyear'" class="sd-tab-2" @click="changeGiftTab('christmas')"></div>
                </div>
                <div class="gift-pic">
                    <img v-show="currentGift==='christmas'" src="${require('./images/xd-sd-gift-1.png')}" alt="">
                    <img v-show="currentGift==='newyear'" src="${require('./images/xd-yd-gift-1.png')}" alt="">
                </div>
                <div class="tips">
                    <!-- <img v-show="currentGift==='christmas'" src="${require('./images/xd-sd-tip-1.png')}" alt="">
                    <img v-show="currentGift==='newyear'" src="${require('./images/xd-yd-tip-1.png')}" alt=""> -->
                    {{ currentGift==='christmas'?'冬日恋歌':'金鼠送福' }}&emsp;9999{{ giftPer }}/个
                </div>
                <div class="gift-btn">
                    <div class="btn-look" @click="preview(1)"></div>
                    <div v-if="activityStatus===1 || (activityStatus===2 && currentGift==='newyear')" class="btn-buy" @click="showPurchasePopup"></div>
                </div>
            </div>
            <div class="gift-block new-year">
                <div class="gift-tab">
                    <div v-show="currentGift==='newyear'" class="yd-tab-1"></div>
                    <div v-show="currentGift==='christmas'" class="yd-tab-2" @click="changeGiftTab('newyear')"></div>
                </div>
                <div class="gift-pic">
                    <img v-show="currentGift==='christmas'" src="${require('./images/xd-sd-gift-2.png')}" alt="">
                    <img v-show="currentGift==='newyear'" src="${require('./images/xd-yd-gift-2.png')}" alt="">
                </div>
                <div class="tips">
                    <!-- <img v-show="currentGift==='christmas'" src="${require('./images/xd-sd-tip-2.png')}" alt="">
                    <img v-show="currentGift==='newyear'" src="${require('./images/xd-yd-tip-2.png')}" alt=""> -->
                    一次性送出99个{{currentGift==='christmas'?'"平安果"':'"元旦贺卡"' }}
                </div>
                <div class="gift-btn">
                    <div class="btn-look" @click="preview(99)"></div>
                </div>
            </div>
        </div>
    </div>
    <!-- 双旦榜单 -->
    <div class="rank-container">
        <div class="rank-title-tab">
            <div class="rank-top-con">
                <div class="tab-sd-yd">
                    <div class="tab-sd-1" v-show="currentRank==='christmas'"></div>
                    <div class="tab-sd-2" v-show="currentRank==='newyear'" @click="changeRankTab('christmas')"></div>
                    <div class="tab-yd-1" v-show="currentRank==='newyear'"></div>
                    <div class="tab-yd-2" v-show="currentRank==='christmas'" @click="changeRankTab('newyear')"></div>
                </div>
                <div class="tab-zb-yh">
                    <div class="tab-zb-1" v-show="rankType===1"></div>
                    <div class="tab-zb-2" v-show="rankType===2" @click="changeRankType(1)"></div>
                    <div class="tab-yh-1" v-show="rankType===2"></div>
                    <div class="tab-yh-2" v-show="rankType===1" @click="changeRankType(2)"></div>
                </div>
            </div>
        </div>
        <div class="rank-top-three">
            <div class="top-three second">
                <div class="avatar" @click="redirectRoom(rankList[1])">
                    <span class="live" v-if="rankList[1] && rankList[1].isPlaying"></span>
                    <img v-if="rankList[1] && rankList[1].headPic" :src="rankList[1].headPic" alt="">
                    <img v-else src="${require('./images/xwyd.png')}" alt="">
                </div>
                <div class="name">
                    <p class=" txt-of">{{ rankList[1] && rankList[1].nickname || "虚位以待" }}</p>
                    <span v-if="rankList[1]" :class="`level_icon ${rankType===1?'m':'u'}_level_icon_${rankList[1].level}`"></span>
                </div>
                <div class="pingan-val txt-of">{{currentRank==='christmas'?'平安值':'福气值'}}:{{ rankList[1] && rankList[1].score || "-" }}</div>
                <div class="follow" v-if="rankList[1] && rankType===1">
                    <span class="followed" v-if="rankList[1].isLoved"></span>
                    <span class="unfollow" v-if="!rankList[1].isLoved" @click="follow(rankList[1])"></span>
                </div>
            </div>
            <div class="top-three first">
                <div class="avatar" @click="redirectRoom(rankList[0])">
                    <span class="live" v-if="rankList[0] && rankList[0].isPlaying"></span>
                    <img v-if="rankList[0] && rankList[0].headPic" :src="rankList[0].headPic" alt="">
                    <img v-else src="${require('./images/xwyd.png')}" alt="">
                </div>
                <div class="name">
                    <p class="txt-of">{{ rankList[0] && rankList[0].nickname || "虚位以待" }}</p>
                    <span v-if="rankList[0]" :class="`level_icon ${rankType===1?'m':'u'}_level_icon_${rankList[0].level}`"></span>
                </div>
                <div class="pingan-val txt-of">{{currentRank==='christmas'?'平安值':'福气值'}}:{{ rankList[0] && rankList[0].score || "-" }}</div>
                <div class="follow" v-if="rankList[0] && rankType===1">
                    <span class="followed" v-if="rankList[0].isLoved"></span>
                    <span class="unfollow" v-if="!rankList[0].isLoved" @click="follow(rankList[0])"></span>
                </div>
            </div>
            <div class="top-three third">
                <div class="avatar" @click="redirectRoom(rankList[2])">
                    <span class="live" v-if="rankList[2] && rankList[2].isPlaying"></span>
                    <img v-if="rankList[2] && rankList[2].headPic" :src="rankList[2].headPic" alt="">
                    <img v-else src="${require('./images/xwyd.png')}" alt="">
                </div>
                <div class="name">
                    <p class="txt-of">{{ rankList[2] && rankList[2].nickname || "虚位以待" }}</p>
                    <span v-if="rankList[2]" :class="`level_icon ${rankType===1?'m':'u'}_level_icon_${rankList[2].level}`"></span>
                </div>
                <div class="pingan-val txt-of">{{currentRank==='christmas'?'平安值':'福气值'}}:{{ rankList[2] && rankList[2].score || "-" }}</div>
                <div class="follow" v-if="rankList[2] && rankType===1">
                    <span class="followed" v-if="rankList[2].isLoved"></span>
                    <span class="unfollow" v-if="!rankList[2].isLoved" @click="follow(rankList[2])"></span>
                </div>
            </div>
        </div>
        <div class="rank-list">
            <div class="list-title">
                <span>排名</span>
                <span>{{ rankType===1 ? '主播' : '用户' }}</span>
                <span>{{currentRank==='christmas'?'平安值':'福气值'}}</span>
            </div>
            <div class="list-con">
                <pc-scroller class="rank-scroller" ref="rank-scroller" thumb-color="rgba(255, 255, 255, 0.5)">
                    <ul>
                        <li v-for="(item, index) in rankList.slice(3)">
                            <span class="keys">{{ index+4 }}</span>
                            <div class="avatar" @click="redirectRoom(item)">
                                <span class="live" v-if="item && item.isPlaying"></span>
                                <img v-if="item.headPic" :src="item.headPic" alt=""> 
                                <img v-else src="${require('./images/xwyd.png')}" alt="">
                            </div>
                            <div class="name txt-of">
                                {{ item && item.nickname || "虚位以待" }}
                                <span v-if="item" :class="`level_icon ${rankType===1?'m':'u'}_level_icon_${item.level}`"></span>
                            </div>
                            <div class="gift-val txt-of">{{ item && item.score || "-" }}</div>
                        </li>
                    </ul>
                </pc-scroller>
                <!-- <ul class="rank-scroller">
                    <li v-for="(item, index) in rankList.slice(3)">
                        <span class="keys">{{ index+4 }}</span>
                        <div class="avatar" @click="redirectRoom(item)">
                            <span class="live" v-if="item && item.isPlaying"></span>
                            <img v-if="item.headPic" :src="item.headPic" alt=""> 
                            <img v-else src="${require('./images/xwyd.png')}" alt="">
                        </div>
                        <div class="name txt-of">
                            {{ item && item.nickname || "虚位以待" }}
                            <span v-if="item" :class="`level_icon ${rankType===1?'m':'u'}_level_icon_${item.level}`"></span>
                        </div>
                        <div class="gift-val txt-of">{{ item && item.score || "-" }}</div>
                    </li>
                </ul> -->
            </div>
        </div>
        <div :class="(isLogin && (isMod || rankType===2)) ? 'rank-self' : 'no-show'">
            <div class="tip">当前只展示前100名{{ rankType===1 ? '主播' : '用户' }}</div>
            <div class="self-container" v-if="isLogin && (isMod || rankType===2)">
                <div class="block block-1">
                    <div class="avatar" @click="redirectRoom(myRank)">
                        <span class="live" v-if="myRank && myRank.isPlaying"></span>
                        <img :src="myRank && myRank.headPic" alt="">
                    </div>
                    <div class="name txt-of">
                        {{ myRank && myRank.nickName }}
                        <span v-if="myRank" :class="`level_icon ${rankType===1?'m':'u'}_level_icon_${myRank.level}`"></span>
                    </div>
                </div>
                <div class="block block-2">
                    <div class="tl">
                        <span>{{ myRank && myRank.pairInfos[0].name }}</span>
                        <p>{{ myRank && myRank.pairInfos[0].value }}</p>
                    </div>
                    <div class="bl">
                        <span>{{ myRank && myRank.pairInfos[1].name }}</span>
                        <p>{{ myRank && myRank.pairInfos[1].value }}</p>
                    </div>
                </div>
                <div class="block block-3">
                    <div class="tr">
                        <span>{{ myRank && myRank.pairInfos[2].name }}</span>
                        <p>{{ myRank && myRank.pairInfos[2].value }}</p>
                    </div>
                    <div class="br">
                        <span>{{ myRank && myRank.pairInfos[3].name }}</span>
                        <p>{{ myRank && myRank.pairInfos[3].value }}</p>
                    </div>
                </div>
            </div>
        </div>
    </div>
    <!-- 祝福墙 -->
    <div class="wish-panel" v-if="[0, 1].includes(activityStatus)">
        <div class="title"></div>
        <div class="wish-container">
            <div class="list-con">
                <div v-if="!wishWallList.length" class="tip">一次性送出99个“平安果”就能发出祝福哦~</div>
                <ul id="wish-rollup-wall" class="wish-rollup-wall" v-if="wishWallList.length">
                    <li v-for="item in wishWallList">
                        <div class="icon"></div>
                        <div class="con">
                            <div class="name">
                                <p class="left txt-of">{{ item.userNickname }}</p>
                                <p class="right txt-of">{{ item.modNickname }}</p>
                            </div>
                            <div class="txt txt-of">{{ item.msg }}</div>
                        </div>
                    </li>
                </ul>
                <ul id="wish-rollup-wall" class="wish-rollup-wall" v-if="wishWallList.length > 5">
                    <li v-for="item in wishWallList">
                        <div class="icon"></div>
                        <div class="con">
                            <div class="name">
                                <p class="left txt-of">{{ item.userNickname }}</p>
                                <p class="right txt-of">{{ item.modNickname }}</p>
                            </div>
                            <div class="txt txt-of">{{ item.msg }}</div>
                        </div>
                    </li>
                </ul>
            </div>
        </div>
    </div>
    <!-- footer说明 -->
    <footer class="copyright">在法律允许的范围内，本活动最终解释权归平台运营团队所有</footer>

    <!-- 礼物预览 -->
    <svg-player ref="svgPlayer"></svg-player>

    <!-- 活动规则按钮 -->
    <div class="rule-btn" @click="showRulePopup=true"></div>

    <!-- 活动规则弹窗 -->
    <div class="popup-module" v-show="showRulePopup">
        <div class="mask">
            <div class="content popup-rule">
                <div class="icon">
                    <div v-show="rulePopupType==='christmas'" class="icon-sd"></div>
                    <div v-show="rulePopupType==='newyear'" class="icon-yd"></div>
                </div>
                <i class="close" @click="showRulePopup=false">关闭</i>
                <div class="tab-group">
                    <div class="tab-sd-1" v-show="rulePopupType==='christmas'"></div>
                    <div class="tab-sd-2" v-show="rulePopupType==='newyear'" @click="changeRulePopupTab('christmas')"></div>
                    <div class="tab-yd-1" v-show="rulePopupType==='newyear'"></div>
                    <div class="tab-yd-2" v-show="rulePopupType==='christmas'" @click="changeRulePopupTab('newyear')"></div>
                </div>
                <div class="details">
                    <pc-scroller class="rule-scroller" ref="rule-scroller" thumb-color="rgba(255, 255, 255, 0.5)">
                        <!-- <img v-show="rulePopupType==='christmas'" src="${require('./images/popup-rule-sd.png')}" alt="">
                        <img v-show="rulePopupType==='newyear'" src="${require('./images/popup-rule-yd.png')}" alt=""> -->
                        <div v-show="rulePopupType==='christmas'" class="rule-sd">
                            <div class="rule-item">1.活动时间：2019.12.24 12:00:00-2019.12.28 23:59:59</div>
                            <div class="rule-item">
                                <p>2.活动礼物：</p>
                                <div class="gift-pic">
                                    <div class="gift-sd-1">
                                        <p><span>=10{{ giftPer }}</span><br><span>=10平安值</span></p>
                                    </div>
                                    <div class="gift-sd-2">
                                        <p><span>=9999{{ giftPer }}</span><br><span>=9999平安值</span></p>
                                    </div>
                                </div>
                            </div>
                            <div class="rule-item">
                                <p>3.用户化身圣诞老人，给可爱的主播送上平安果。送出指定数量的平安果，直播间掉落圣诞礼物。每天0点刷新直播间进度条，0点后，集满当前进度条平安果，再从第一轮（500个平安果）送出。</p>
                                <div class="pic-3"></div>
                            </div>
                            <div class="rule-item">4. 用户一次性送出99个平安果，可触发圣诞动效加房间祝福飘屏。</div>
                            <div class="rule-item">
                                <p>5. 圣诞主播榜前5名获得奖励，排名按照平安值高低排序，若有相同成绩，则按照先到先得原则排名。奖励将于双旦活动结束后7个工作日内发放。</p>
                                <table>
                                    <tr>
                                        <td>圣诞主播榜</td>
                                        <td>奖励（{{ giftPer }}）</td>
                                    </tr>
                                    <tr>
                                        <td>第一名</td>
                                        <td>300000</td>
                                    </tr>
                                    <tr>
                                        <td>第二名</td>
                                        <td>200000</td>
                                    </tr>
                                    <tr>
                                        <td>第三名</td>
                                        <td>150000</td>
                                    </tr>
                                    <tr>
                                        <td>第四、五名</td>
                                        <td>100000</td>
                                    </tr>
                                </table>
                            </div>
                        </div>
                        <div v-show="rulePopupType==='newyear'" class="rule-yd">
                            <div class="rule-item">1. 活动时间：2019.12.31  10:00:00-2020.1.1 23:59:59</div>
                            <div class="rule-item">
                                <p>2. 活动礼物：</p>
                                <div class="gift-pic">
                                    <div class="gift-yd-1">
                                        <p><span>=10{{ giftPer }}</span><br><span>=10福气值</span></p>
                                    </div>
                                    <div class="gift-yd-2">
                                        <p><span>=9999{{ giftPer }}</span><br><span>=9999福气值</span></p>
                                    </div>
                                </div>
                            </div>
                            <div class="rule-item">
                                <p>3. 用户一次性送出99个元旦贺卡，可触发元旦动效。</p>
                            </div>
                            <div class="rule-item">
                                <p>4. 活动期间，以下礼物限时5折售卖（以下礼物也参与霸屏！）</p>
                                <div class="discount">
                                    <div class="discount-gift">
                                        <div class="pic discount-1"></div>
                                        <p class="new-price">26000{{ giftPer }}</p>
                                        <p class="old-price">52000{{ giftPer }}</p>
                                    </div>
                                    <div class="discount-gift">
                                        <div class="pic discount-2"></div>
                                        <p class="new-price">4999{{ giftPer }}</p>
                                        <p class="old-price">9999{{ giftPer }}</p>
                                    </div>
                                    <div class="discount-gift">
                                        <div class="pic discount-3"></div>
                                        <p class="new-price">1499{{ giftPer }}</p>
                                        <p class="old-price">2999{{ giftPer }}</p>
                                    </div>
                                </div>
                            </div>
                            <div class="rule-item">5. 活动期间，主播按照收取活动礼物及以上三种打折礼物，按照1{{ giftPer }}=1福气值进行榜单排名，若有相同成绩者，按照先到先得原则排名。</div>
                            <div class="rule-item">
                                <p>6. 活动期间，用户送出活动礼物及以上三种打折礼物，用户经验值、粉丝亲密度翻倍！</p>
                                <p class="example">例：用户A送给主播B一个宠你上天，价值26000{{ giftPer }}。活动榜单记录26000{{ giftPer }}，主播B直播间记录26000星光值。用户A的用户经验值、粉丝亲密度记录26000*2=52000。主播分成为折后礼物分成。</p>
                            </div>
                            <div class="rule-item">7. 2020.1.1 00:00:00，全平台所有开播的直播间将自动派发跨年红包！一起来为新的一年狂欢吧~</div>
                            <div class="rule-item">
                                <p>8. 元旦主播榜前三名主播获得奖励。</p>
                                <table cellpadding="0" cellspacing="0">
                                    <tr>
                                        <td>元旦主播榜</td>
                                        <td>奖励</td>
                                    </tr>
                                    <tr>
                                        <td>第一名</td>
                                        <td>2020开年开屏*2日、金鼠送福*10</td>
                                    </tr>
                                    <tr>
                                        <td>第二名</td>
                                        <td>金鼠送福*5</td>
                                    </tr>
                                    <tr>
                                        <td>第三名</td>
                                        <td>金鼠送福*3</td>
                                    </tr>
                                </table>
                            </div>
                            <div class="rule-item tip">注：2020开年开屏上线周期为：2020.1.2 12:00:00-2020.1.4 12:00:00。</div>
                        </div>
                    </pc-scroller>
                </div>
            </div>
        </div>
    </div>

    <!-- 购买弹窗 -->
    <div class="popup-module" v-show="showXdBuyPopup">
        <div class="mask">
            <div class="content popup-buy">
                <i class="close" @click="showXdBuyPopup=false">关闭</i>
                <div class="buy-step-1" v-show="purchaseStep === 1">
                    <p>购买：<input class="num" @input="inputRuleReg" maxlength="4" v-model="giftNumber" autofocus></input>个</p>
                    <p>价格：<span class="price">{{ giftTotalPrice }}</span>{{ giftPer }}</p>
                    <div class="btn-group">
                        <div class="btn-confirm" @click="confirmPurchase"></div>
                    </div>
                </div>
                <div class="buy-step-2" v-show="purchaseStep === 2">
                    <p>余额不足，快去充值吧！</p>
                    <div class="btn-group">
                        <div class="btn-no" @click="showXdBuyPopup=false"></div>
                        <div class="btn-recharge" @click="goRecharge"></div>
                    </div>
                </div>
            </div>
        </div>
    </div>

    <loading ref="loading"></loading>

    <toast ref="toast"></toast>
</div>
<!-- mixin html content -->